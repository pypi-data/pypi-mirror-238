{% load i18n admin_urls static admin_list spags %}
<div class="table-toolbar">
    {% if cl.formset and cl.formset.errors %}
        <p class="errornote">
            {% blocktranslate count counter=cl.formset.total_error_count %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktranslate %}
        </p>
        {{ cl.formset.non_form_errors }}
    {% endif %}
    <!--顶部左侧区域-->
    <div class="flex items-center table-toolbar-left">
        {% block object-tools-items %}
            {% change_list_object_tools %}
        {% endblock %}

        {% block result_list %}
            {% if action_form %}{% admin_actions %}{% endif %}
        {% endblock %}
    </div>
    {% verbatim %}
    <n-p style="margin-left: 5px"> 你选中了 {{ checkedRowKeysRef.length }} 行。</n-p>
    {% endverbatim %}
    <div class="flex items-center table-toolbar-right">
        <!--顶部右侧区域-->
        <n-button type="primary" @click="reloadTable">刷新数据</n-button>

        <!--斑马纹-->
        <n-tooltip trigger="hover">
            <template #trigger>
                <div class="mr-2 table-toolbar-right-icon">
                    <n-switch v-model:value="isStriped" @update:value="setStriped"></n-switch>
                </div>
            </template>
            <span>表格斑马纹</span>
        </n-tooltip>
        <n-divider vertical></n-divider>

        <!--刷新-->
        {% if has_export_permission %}
            <n-tooltip trigger="hover">
                <template #trigger>
                    <div class="table-toolbar-right-icon"
                         @click="exports_all('{% url opts|admin_urlname:'export' %}{{ cl.get_query_string }}')">
                        <n-icon size="18">
                            <img src="{% static '/naive-ui/svg/archive-icon.svg' %}" alt="">
                        </n-icon>
                    </div>
                </template>
                <span>全部导出</span>
            </n-tooltip>
        {% endif %}

        <!--密度-->
        <n-tooltip trigger="hover">
            <template #trigger>
                <div class="table-toolbar-right-icon">
                    <n-dropdown
                            @select="densitySelect"
                            trigger="click"
                            :options="densityOptions"
                            v-model:value="tableSize"
                    >
                        <n-icon size="18">
                            <i class="fa-solid fa-table-columns"></i>
                        </n-icon>
                    </n-dropdown>
                </div>
            </template>
            <span>密度</span>
        </n-tooltip>

        <!--表格设置单独抽离成组件-->
        {#  <ColumnSetting></ColumnSetting>#}
    </div>
</div>
<div class="s-table">
    <n-data-table
            ref="tableElRef"
            {#      v-bind="getBindValues"#}
            :columns="results.columns"
            :data="results.data"
            :striped="isStriped"
            :pagination="pagination"
            {#      @update:page="updatePage"#}
            {#      @update:page-size="updatePageSize"#}
            :row-key="rowKey"
            max-height=340px
            @update:checked-row-keys="handleCheck"
    >
        <template #[item]="data" v-for="item in Object.keys($slots)" :key="item">
            <slot :name="item" v-bind="data"></slot>
        </template>
    </n-data-table>
</div>