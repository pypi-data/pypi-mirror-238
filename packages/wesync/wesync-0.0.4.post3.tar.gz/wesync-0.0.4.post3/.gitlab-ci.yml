variables:
  GIT_STRATEGY: recursive

build:
  image:
    name: python:3.11-alpine
    entrypoint:
      - ""
  rules:
    - if: $CI_COMMIT_TAG
  tags:
    - deployer
  needs: []
  script:
    - pip install build twine hatch
    - python -m hatch version $CI_COMMIT_TAG
    - rm -rf dist
    - python -m build
    - python -m twine check dist/*
    - python -m twine upload --non-interactive --disable-progress-bar dist/*
