"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[89806],{89806:function(e,t,r){r.r(t);var i,n=require("@babel/runtime/helpers/taggedTemplateLiteral").default,a=require("@babel/runtime/helpers/classCallCheck").default,s=require("@babel/runtime/helpers/createClass").default,o=require("@babel/runtime/helpers/inherits").default,u=require("@babel/runtime/helpers/createSuper").default,c=require("@babel/runtime/helpers/regeneratorRuntime").default,l=require("@babel/runtime/helpers/slicedToArray").default,f=require("@babel/runtime/helpers/createForOfIteratorHelper").default,d=require("@babel/runtime/helpers/asyncToGenerator").default,h=require("@babel/runtime/helpers/typeof").default;!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==h(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);var p=customElements.get("home-assistant-main")?Object.getPrototypeOf(customElements.get("home-assistant-main")):Object.getPrototypeOf(customElements.get("hui-view")),g=p.prototype.html;function y(){return document.querySelector("hc-main")?document.querySelector("hc-main").hass:document.querySelector("home-assistant")?document.querySelector("home-assistant").hass:void 0}p.prototype.css;var v=y().callWS({type:"config/area_registry/list"}),m=y().callWS({type:"config/device_registry/list"}),b=y().callWS({type:"config/entity_registry/list"});function _(){return w.apply(this,arguments)}function w(){return(w=d(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=window.cardToolsData,e.t0){e.next=12;break}return e.next=4,v;case 4:return e.t1=e.sent,e.next=7,m;case 7:return e.t2=e.sent,e.next=10,b;case 10:e.t3=e.sent,e.t0={areas:e.t1,devices:e.t2,entities:e.t3};case 12:return window.cardToolsData=e.t0,e.abrupt("return",window.cardToolsData);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=window.cardToolsData,r=[];if(!e)return r;var i,n=f(t.devices);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.area_id===e.area_id&&r.push(a)}}catch(s){n.e(s)}finally{n.f()}return r}function k(e){var t=window.cardToolsData,r=[];if(!e)return r;var i,n=f(t.entities);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.device_id===e.id&&r.push(a.entity_id)}}catch(s){n.e(s)}finally{n.f()}return r}function O(e,t){if("string"==typeof t&&"string"==typeof e&&(e.startsWith("/")&&e.endsWith("/")||-1!==e.indexOf("*")))return e.startsWith("/")||(e="/^".concat(e=e.replace(/\./g,".").replace(/\*/g,".*"),"$/")),new RegExp(e.slice(1,-1)).test(t);if("string"==typeof e){if(e.startsWith("<="))return parseFloat(t)<=parseFloat(e.substr(2));if(e.startsWith(">="))return parseFloat(t)>=parseFloat(e.substr(2));if(e.startsWith("<"))return parseFloat(t)<parseFloat(e.substr(1));if(e.startsWith(">"))return parseFloat(t)>parseFloat(e.substr(1));if(e.startsWith("!"))return parseFloat(t)!=parseFloat(e.substr(1));if(e.startsWith("="))return parseFloat(t)==parseFloat(e.substr(1))}return e===t}function C(e,t){return function(r){var i="string"==typeof r?e.states[r]:e.states[r.entity];if(!r)return!1;for(var n=0,a=Object.entries(t);n<a.length;n++){var s=l(a[n],2),o=(s[0],s[1]);switch(g.split(" ")[0]){case"options":case"sort":break;case"domain":if(!O(o,i.entity_id.split(".")[0]))return!1;break;case"entity_id":if(!O(o,i.entity_id))return!1;break;case"state":if(!O(o,i.state))return!1;break;case"name":if(!i.attributes.friendly_name||!O(o,i.attributes.friendly_name))return!1;break;case"group":if(!(o.startsWith("group.")&&e.states[o]&&e.states[o].attributes.entity_id&&e.states[o].attributes.entity_id.includes(i.entity_id)))return!1;break;case"attributes":for(var u=0,c=Object.entries(o);u<c.length;u++){for(var d=l(c[u],2),h=d[0],p=d[1],y=h.trim(),v=i.attributes;y&&v;){var m,b,_;m=y.split(":"),_=(b=l(m,2))[0],y=b[1],v=v[_]}if(void 0===v||void 0!==p&&!O(p,v))return!1}break;case"not":if(C(e,o)(r))return!1;break;case"device":if(!window.cardToolsData||!window.cardToolsData.devices)return!1;var w,T=!1,j=f(window.cardToolsData.devices);try{for(j.s();!(w=j.n()).done;){var q=w.value;O(o,q.name)&&k(q).includes(i.entity_id)&&(T=!0)}}catch(N){j.e(N)}finally{j.f()}if(!T)return!1;break;case"area":if(!window.cardToolsData||!window.cardToolsData.areas)return!1;var D,E=!1,F=f(window.cardToolsData.areas);try{for(F.s();!(D=F.n()).done;){var x=D.value;O(o,x.name)&&S(x).flatMap(k).includes(i.entity_id)&&(E=!0)}}catch(N){F.e(N)}finally{F.f()}if(!E)return!1;break;case"last_changed":if(!O(o,((new Date).getTime()-new Date(i.last_changed).getTime())/6e4))return!1;break;case"last_updated":if(!O(o,((new Date).getTime()-new Date(i.last_updated).getTime())/6e4))return!1;break;default:return!1}}return!0}}function T(e,t){return"string"==typeof t&&(t={method:t}),function(r,i){var n="string"==typeof r?e.states[r]:e.states[r.entity],a="string"==typeof i?e.states[i]:e.states[i.entity];if(void 0===n||void 0===a)return 0;var s=t.reverse?[-1,1]:[1,-1],o=l(s,2),u=o[0],c=o[1];function f(e,r){return t.ignore_case&&e.toLowerCase&&(e=e.toLowerCase()),t.ignore_case&&r.toLowerCase&&(r=r.toLowerCase()),t.numeric&&(isNaN(parseFloat(e))&&isNaN(parseFloat(r))||(e=isNaN(parseFloat(e))?void 0:parseFloat(e),r=isNaN(parseFloat(r))?void 0:parseFloat(r))),void 0===e&&void 0===r?0:void 0===e?u:void 0===r||e<r?c:e>r?u:0}switch(t.method){case"domain":return f(n.entity_id.split(".")[0],a.entity_id.split(".")[0]);case"entity_id":return f(n.entity_id,a.entity_id);case"friendly_name":case"name":return f(n.attributes.friendly_name||n.entity_id.split(".")[1],a.attributes.friendly_name||a.entity_id.split(".")[1]);case"state":return f(n.state,a.state);case"attribute":for(var d=n.attributes,h=a.attributes,p=t.attribute;p;){var g,y,v;if(g=p.split(":"),v=(y=l(g,2))[0],p=y[1],d=d[v],h=h[v],void 0===d&&void 0===h)return 0;if(void 0===d)return u;if(void 0===h)return c}return f(d,h);case"last_changed":case"last_updated":return t.numeric=!0,f(new Date(a.last_changed).getTime(),new Date(n.last_changed).getTime());case"last_triggered":return null==n.attributes.last_triggered||null==a.attributes.last_triggered?0:(t.numeric=!0,f(new Date(a.attributes.last_triggered).getTime(),new Date(n.attributes.last_triggered).getTime()));default:return 0}}}function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((e=new Event(e,{bubbles:!0,cancelable:!1,composed:!0})).detail=t||{},r)r.dispatchEvent(e);else{var i=function(){var e=document.querySelector("hc-main");return e?(e=(e=(e=e&&e.shadowRoot)&&e.querySelector("hc-lovelace"))&&e.shadowRoot)&&e.querySelector("hui-view"):(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=document.querySelector("home-assistant"))&&e.shadowRoot)&&e.querySelector("home-assistant-main"))&&e.shadowRoot)&&e.querySelector("app-drawer-layout partial-panel-resolver"))&&e.shadowRoot||e)&&e.querySelector("ha-panel-lovelace"))&&e.shadowRoot)&&e.querySelector("hui-root"))&&e.shadowRoot)&&e.querySelector("ha-app-layout #view"))&&e.firstElementChild}();i&&i.dispatchEvent(e)}}_();var q=window.cardHelpers,D=new Promise(function(){var e=d(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q&&t(),e.t0=window.loadCardHelpers,!e.t0){e.next=8;break}return e.next=5,window.loadCardHelpers();case 5:q=e.sent,window.cardHelpers=q,t();case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());function E(e,t){var r=document.createElement("hui-error-card");return r.setConfig({type:"error",error:e,origConfig:t}),D.then((function(){j("ll-rebuild",{},r)})),r}var F=function(){if(window.fully&&"function"==typeof fully.getDeviceId)return fully.getDeviceId();if(!localStorage["lovelace-player-device-id"]){var e=function(){return Math.floor(1e5*(1+Math.random())).toString(16).substring(1)};localStorage["lovelace-player-device-id"]="".concat(e()).concat(e(),"-").concat(e()).concat(e())}return localStorage["lovelace-player-device-id"]}();customElements.define("hui-ais-monster-card",function(e){o(r,e);var t=u(r);function r(){return a(this,r),t.apply(this,arguments)}return s(r,[{key:"setConfig",value:function(e){var t=this;if(!e||!e.card)throw new Error("Invalid configuration");e=JSON.parse(JSON.stringify(e)),this._config?(this._config=e,this.hass=this.hass):(this._config=e,this.hass=y(),this._getEntities(),this.cardConfig=Object.assign({entities:this.entities},e.card),this.card=function(e){return q?q.createCardElement(e):function(e,t){if(!t||"object"!=h(t)||!t.type)return E("No ".concat(e," type configured"),t);var r=t.type;if(r=r.startsWith("custom:")?r.substr(7):"hui-".concat(r,"-").concat(e),customElements.get(r))return function(e,t){var r=document.createElement(e);try{r.setConfig(JSON.parse(JSON.stringify(t)))}catch(e){r=E(e,t)}return D.then((function(){j("ll-rebuild",{},r)})),r}(r,t);var i=E("Custom element doesn't exist: ".concat(r,"."),t);i.style.display="None";var n=setTimeout((function(){i.style.display=""}),2e3);return customElements.whenDefined(r).then((function(){clearTimeout(n),j("ll-rebuild",{},i)})),i}("card",e)}(this.cardConfig)),e.filter&&e.filter.template&&(this.template="",(String(e.filter.template).includes("{%")||String(e.filter.template).includes("{{"))&&function(e,r,i){e||(e=y().connection);var n=Object.assign({user:y().user.name,browser:F,hash:location.hash.substr(1)||" "},i.variables),a=i.template,s=i.entity_ids;e.subscribeMessage((function(e){var r=e.result;r=r.replace(/_\([^)]*\)/g,(function(e){return y().localize(e.substring(2,e.length-1))||e})),function(e){t.template=e,t._getEntities()}(r)}),{type:"render_template",template:a,variables:n,entity_ids:s})}(null,0,{template:e.filter.template,variables:{config:e},entity_ids:e.filter.entity_ids})),_().then((function(){return t._getEntities()}))}},{key:"_getEntities",value:function(){var e=this,t=function(e){return e?"string"==typeof e?{entity:e.trim()}:e:null},r=[];if(this._config.entities&&(r=r.concat(this._config.entities.map(t))),!this.hass||!this._config.filter)return r;if(this.template&&(r=r.concat(this.template.split(/[\s,]+/).map(t))),r=r.filter(Boolean),this._config.filter.include){var i,n=Object.keys(this.hass.states).map(t),a=f(this._config.filter.include);try{var s=function(){var t=i.value;if(void 0!==t.type)return r.push(t),1;var a=n.filter(C(e.hass,t)).map((function(e){return JSON.parse(JSON.stringify(new Object(Object.assign(Object.assign({},e),t.options))).replace(/this.entity_id/g,e.entity))}));void 0!==t.sort&&(a=a.sort(T(e.hass,t.sort))),r=r.concat(a)};for(a.s();!(i=a.n()).done;)s()}catch(m){a.e(m)}finally{a.f()}}if(this._config.filter.exclude){var o,u=f(this._config.filter.exclude);try{var c=function(){var t=o.value;r=r.filter((function(r){return"string"!=typeof r&&void 0===r.entity||!C(e.hass,t)(r)}))};for(u.s();!(o=u.n()).done;)c()}catch(m){u.e(m)}finally{u.f()}}if(this._config.sort&&(r=r.sort(T(this.hass,this._config.sort)),this._config.sort.count)){var l=this._config.sort.first||0;r=r.slice(l,l+this._config.sort.count)}if(this._config.unique){var d,p=function e(t,r){return h(t)==h(r)&&("object"!=h(t)?t===r:!Object.keys(t).some((function(e){return!Object.keys(r).includes(e)}))&&Object.keys(t).every((function(i){return e(t[i],r[i])})))},g=[],y=f(r);try{var v=function(){var e=d.value;g.some((function(t){return p(t,e)}))||g.push(e)};for(y.s();!(d=y.n()).done;)v()}catch(m){y.e(m)}finally{y.f()}r=g}this.entities=r}},{key:"entities",get:function(){return this._entities},set:function(e){(function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(JSON.stringify(e[r])!==JSON.stringify(t[r]))return!1;return!0})(e,this._entities)||(this._entities=e,this.cardConfig=Object.assign(Object.assign({},this.cardConfig),{},{entities:this._entities}),0===e.length&&!1===this._config.show_empty?(this.style.display="none",this.style.margin="0"):(this.style.display=null,this.style.margin=null))}},{key:"cardConfig",get:function(){return this._cardConfig},set:function(e){this._cardConfig=e,this.card&&this.card.setConfig(e)}},{key:"updated",value:function(e){var t=this;e.has("hass")&&this.hass&&(this.card.hass=this.hass,setTimeout((function(){return t._getEntities()}),0))}},{key:"createRenderRoot",value:function(){return this}},{key:"render",value:function(){return g(i||(i=n(["\n    ",""])),this.card)}},{key:"getCardSize",value:function(){var e=0;return this.card&&this.card.getCardSize&&(e=this.card.getCardSize()),1===e&&this.entities.length&&(e=this.entities.length),0===e&&this._config.filter&&this._config.filter.include&&(e=Object.keys(this._config.filter.include).length),e||1}}],[{key:"properties",get:function(){return{hass:{}}}}]),r}(p)),j("ll-rebuild",{})}])}}]);
//# sourceMappingURL=89806-y0ztVGYMtWI.js.map