import"./Button-8eeccca1.js";import{u as $t}from"./utils-c3e3db58.js";import{B as ft}from"./BlockLabel-e3970ebb.js";import{I as je}from"./IconButton-0233c52d.js";import{E as yt}from"./Empty-eeaba2d1.js";import{S as Ct}from"./ShareButton-8c2e0671.js";import{D as It}from"./Download-696bd40c.js";import"./Index-c74a8b7c.js";import{I as ze}from"./Image-eaba773f.js";import{n as We}from"./index-50ad4c77.js";import{a as St}from"./UploadText-21079d8e.js";import{D as dt}from"./DropdownArrow-a83f7316.js";import{U as qt}from"./Upload-5621fe61.js";/* empty css                                                   */import{C as Dt}from"./Clear-2c7bae91.js";const{SvelteComponent:Mt,append:Pe,attr:W,detach:Et,init:Wt,insert:Bt,noop:ye,safe_not_equal:Ht,svg_element:Ce}=window.__gradio__svelte__internal;function Ut(o){let e,n,t;return{c(){e=Ce("svg"),n=Ce("path"),t=Ce("circle"),W(n,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),W(t,"cx","12"),W(t,"cy","13"),W(t,"r","4"),W(e,"xmlns","http://www.w3.org/2000/svg"),W(e,"width","100%"),W(e,"height","100%"),W(e,"viewBox","0 0 24 24"),W(e,"fill","none"),W(e,"stroke","currentColor"),W(e,"stroke-width","1.5"),W(e,"stroke-linecap","round"),W(e,"stroke-linejoin","round"),W(e,"class","feather feather-camera")},m(l,r){Bt(l,e,r),Pe(e,n),Pe(e,t)},p:ye,i:ye,o:ye,d(l){l&&Et(e)}}}class Rt extends Mt{constructor(e){super(),Wt(this,e,null,Ut,Ht,{})}}const{SvelteComponent:Tt,append:jt,attr:H,detach:zt,init:At,insert:Pt,noop:Ie,safe_not_equal:Lt,svg_element:Le}=window.__gradio__svelte__internal;function Nt(o){let e,n;return{c(){e=Le("svg"),n=Le("circle"),H(n,"cx","12"),H(n,"cy","12"),H(n,"r","10"),H(e,"xmlns","http://www.w3.org/2000/svg"),H(e,"width","100%"),H(e,"height","100%"),H(e,"viewBox","0 0 24 24"),H(e,"fill","red"),H(e,"stroke","red"),H(e,"stroke-width","1.5"),H(e,"stroke-linecap","round"),H(e,"stroke-linejoin","round"),H(e,"class","feather feather-circle")},m(t,l){Pt(t,e,l),jt(e,n)},p:Ie,i:Ie,o:Ie,d(t){t&&zt(e)}}}class Vt extends Tt{constructor(e){super(),At(this,e,null,Nt,Lt,{})}}const{SvelteComponent:Zt,append:Ft,attr:X,detach:Ot,init:Xt,insert:Yt,noop:Se,safe_not_equal:Gt,svg_element:Ne}=window.__gradio__svelte__internal;function Jt(o){let e,n;return{c(){e=Ne("svg"),n=Ne("path"),X(n,"fill","currentColor"),X(n,"d","M13.75 2a2.25 2.25 0 0 1 2.236 2.002V4h1.764A2.25 2.25 0 0 1 20 6.25V11h-1.5V6.25a.75.75 0 0 0-.75-.75h-2.129c-.404.603-1.091 1-1.871 1h-3.5c-.78 0-1.467-.397-1.871-1H6.25a.75.75 0 0 0-.75.75v13.5c0 .414.336.75.75.75h4.78a3.99 3.99 0 0 0 .505 1.5H6.25A2.25 2.25 0 0 1 4 19.75V6.25A2.25 2.25 0 0 1 6.25 4h1.764a2.25 2.25 0 0 1 2.236-2h3.5Zm2.245 2.096L16 4.25c0-.052-.002-.103-.005-.154ZM13.75 3.5h-3.5a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5ZM15 12a3 3 0 0 0-3 3v5c0 .556.151 1.077.415 1.524l3.494-3.494a2.25 2.25 0 0 1 3.182 0l3.494 3.494c.264-.447.415-.968.415-1.524v-5a3 3 0 0 0-3-3h-5Zm0 11a2.985 2.985 0 0 1-1.524-.415l3.494-3.494a.75.75 0 0 1 1.06 0l3.494 3.494A2.985 2.985 0 0 1 20 23h-5Zm5-7a1 1 0 1 1 0-2a1 1 0 0 1 0 2Z"),X(e,"xmlns","http://www.w3.org/2000/svg"),X(e,"width","100%"),X(e,"height","100%"),X(e,"viewBox","0 0 24 24")},m(t,l){Yt(t,e,l),Ft(e,n)},p:Se,i:Se,o:Se,d(t){t&&Ot(e)}}}class Kt extends Zt{constructor(e){super(),Xt(this,e,null,Jt,Gt,{})}}const{SvelteComponent:Qt,append:xt,attr:D,detach:en,init:tn,insert:nn,noop:qe,safe_not_equal:ln,svg_element:Ve}=window.__gradio__svelte__internal;function on(o){let e,n;return{c(){e=Ve("svg"),n=Ve("rect"),D(n,"x","3"),D(n,"y","3"),D(n,"width","18"),D(n,"height","18"),D(n,"rx","2"),D(n,"ry","2"),D(e,"xmlns","http://www.w3.org/2000/svg"),D(e,"width","100%"),D(e,"height","100%"),D(e,"viewBox","0 0 24 24"),D(e,"fill","red"),D(e,"stroke","red"),D(e,"stroke-width","1.5"),D(e,"stroke-linecap","round"),D(e,"stroke-linejoin","round"),D(e,"class","feather feather-square")},m(t,l){nn(t,e,l),xt(e,n)},p:qe,i:qe,o:qe,d(t){t&&en(e)}}}class rn extends Qt{constructor(e){super(),tn(this,e,null,on,ln,{})}}const{SvelteComponent:an,append:Ze,attr:Z,detach:sn,init:cn,insert:un,noop:De,safe_not_equal:_n,svg_element:Me}=window.__gradio__svelte__internal;function fn(o){let e,n,t;return{c(){e=Me("svg"),n=Me("path"),t=Me("path"),Z(n,"fill","currentColor"),Z(n,"d","M12 2c-4.963 0-9 4.038-9 9c0 3.328 1.82 6.232 4.513 7.79l-2.067 1.378A1 1 0 0 0 6 22h12a1 1 0 0 0 .555-1.832l-2.067-1.378C19.18 17.232 21 14.328 21 11c0-4.962-4.037-9-9-9zm0 16c-3.859 0-7-3.141-7-7c0-3.86 3.141-7 7-7s7 3.14 7 7c0 3.859-3.141 7-7 7z"),Z(t,"fill","currentColor"),Z(t,"d","M12 6c-2.757 0-5 2.243-5 5s2.243 5 5 5s5-2.243 5-5s-2.243-5-5-5zm0 8c-1.654 0-3-1.346-3-3s1.346-3 3-3s3 1.346 3 3s-1.346 3-3 3z"),Z(e,"xmlns","http://www.w3.org/2000/svg"),Z(e,"width","100%"),Z(e,"height","100%"),Z(e,"viewBox","0 0 24 24")},m(l,r){un(l,e,r),Ze(e,n),Ze(e,t)},p:De,i:De,o:De,d(l){l&&sn(e)}}}let dn=class extends an{constructor(e){super(),cn(this,e,null,fn,_n,{})}};const{SvelteComponent:mn,attr:gn,create_slot:hn,detach:pn,element:bn,get_all_dirty_from_scope:wn,get_slot_changes:vn,init:kn,insert:$n,safe_not_equal:yn,toggle_class:Fe,transition_in:Cn,transition_out:In,update_slot_base:Sn}=window.__gradio__svelte__internal;function qn(o){let e,n;const t=o[2].default,l=hn(t,o,o[1],null);return{c(){e=bn("div"),l&&l.c(),gn(e,"class","svelte-18gkr7n"),Fe(e,"show_border",o[0])},m(r,i){$n(r,e,i),l&&l.m(e,null),n=!0},p(r,[i]){l&&l.p&&(!n||i&2)&&Sn(l,t,r,r[1],n?vn(t,r[1],i,null):wn(r[1]),null),(!n||i&1)&&Fe(e,"show_border",r[0])},i(r){n||(Cn(l,r),n=!0)},o(r){In(l,r),n=!1},d(r){r&&pn(e),l&&l.d(r)}}}function Dn(o,e,n){let{$$slots:t={},$$scope:l}=e,{show_border:r=!1}=e;return o.$$set=i=>{"show_border"in i&&n(0,r=i.show_border),"$$scope"in i&&n(1,l=i.$$scope)},[r,l,t]}class Mn extends mn{constructor(e){super(),kn(this,e,Dn,qn,yn,{show_border:0})}}const mt=o=>{let e=o.currentTarget;const n=e.getBoundingClientRect(),t=e.naturalWidth/n.width,l=e.naturalHeight/n.height;if(t>l){const u=e.naturalHeight/t,c=(n.height-u)/2;var r=Math.round((o.clientX-n.left)*t),i=Math.round((o.clientY-n.top-c)*t)}else{const u=e.naturalWidth/l,c=(n.width-u)/2;var r=Math.round((o.clientX-n.left-c)*l),i=Math.round((o.clientY-n.top)*l)}return r<0||r>=e.naturalWidth||i<0||i>=e.naturalHeight?null:[r,i]};const{SvelteComponent:En,append:Oe,attr:j,bubble:Xe,check_outros:Be,create_component:re,destroy_component:ie,detach:Y,element:he,empty:Wn,group_outros:He,init:Bn,insert:G,listen:Hn,mount_component:ae,safe_not_equal:Un,space:Ue,src_url_equal:Ye,toggle_class:Ge,transition_in:U,transition_out:z}=window.__gradio__svelte__internal,{createEventDispatcher:Rn}=window.__gradio__svelte__internal;function Tn(o){let e,n,t,l,r,i,u,c,s,a=o[3]&&Je(o),_=o[5]&&Ke(o);return{c(){e=he("div"),a&&a.c(),n=Ue(),_&&_.c(),t=Ue(),l=he("button"),r=he("img"),j(e,"class","icon-buttons svelte-tsr9e2"),Ye(r.src,i=o[0].url)||j(r,"src",i),j(r,"alt",""),j(r,"loading","lazy"),j(r,"class","svelte-tsr9e2"),Ge(r,"selectable",o[4]),j(l,"class","svelte-tsr9e2")},m(f,m){G(f,e,m),a&&a.m(e,null),Oe(e,n),_&&_.m(e,null),G(f,t,m),G(f,l,m),Oe(l,r),u=!0,c||(s=Hn(l,"click",o[7]),c=!0)},p(f,m){f[3]?a?(a.p(f,m),m&8&&U(a,1)):(a=Je(f),a.c(),U(a,1),a.m(e,n)):a&&(He(),z(a,1,1,()=>{a=null}),Be()),f[5]?_?(_.p(f,m),m&32&&U(_,1)):(_=Ke(f),_.c(),U(_,1),_.m(e,null)):_&&(He(),z(_,1,1,()=>{_=null}),Be()),(!u||m&1&&!Ye(r.src,i=f[0].url))&&j(r,"src",i),(!u||m&16)&&Ge(r,"selectable",f[4])},i(f){u||(U(a),U(_),u=!0)},o(f){z(a),z(_),u=!1},d(f){f&&(Y(e),Y(t),Y(l)),a&&a.d(),_&&_.d(),c=!1,s()}}}function jn(o){let e,n;return e=new yt({props:{unpadded_box:!0,size:"large",$$slots:{default:[zn]},$$scope:{ctx:o}}}),{c(){re(e.$$.fragment)},m(t,l){ae(e,t,l),n=!0},p(t,l){const r={};l&8192&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){ie(e,t)}}}function Je(o){let e,n,t,l;return n=new je({props:{Icon:It,label:o[6]("common.download")}}),{c(){e=he("a"),re(n.$$.fragment),j(e,"href",t=o[0].url),j(e,"target",window.__is_colab__?"_blank":null),j(e,"download","image")},m(r,i){G(r,e,i),ae(n,e,null),l=!0},p(r,i){const u={};i&64&&(u.label=r[6]("common.download")),n.$set(u),(!l||i&1&&t!==(t=r[0].url))&&j(e,"href",t)},i(r){l||(U(n.$$.fragment,r),l=!0)},o(r){z(n.$$.fragment,r),l=!1},d(r){r&&Y(e),ie(n)}}}function Ke(o){let e,n;return e=new Ct({props:{i18n:o[6],formatter:o[9],value:o[0]}}),e.$on("share",o[10]),e.$on("error",o[11]),{c(){re(e.$$.fragment)},m(t,l){ae(e,t,l),n=!0},p(t,l){const r={};l&64&&(r.i18n=t[6]),l&1&&(r.value=t[0]),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){ie(e,t)}}}function zn(o){let e,n;return e=new ze({}),{c(){re(e.$$.fragment)},m(t,l){ae(e,t,l),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){ie(e,t)}}}function An(o){let e,n,t,l,r,i;e=new ft({props:{show_label:o[2],Icon:ze,label:o[1]||o[6]("image.image")}});const u=[jn,Tn],c=[];function s(a,_){return a[0]===null||!a[0].url?0:1}return t=s(o),l=c[t]=u[t](o),{c(){re(e.$$.fragment),n=Ue(),l.c(),r=Wn()},m(a,_){ae(e,a,_),G(a,n,_),c[t].m(a,_),G(a,r,_),i=!0},p(a,[_]){const f={};_&4&&(f.show_label=a[2]),_&66&&(f.label=a[1]||a[6]("image.image")),e.$set(f);let m=t;t=s(a),t===m?c[t].p(a,_):(He(),z(c[m],1,1,()=>{c[m]=null}),Be(),l=c[t],l?l.p(a,_):(l=c[t]=u[t](a),l.c()),U(l,1),l.m(r.parentNode,r))},i(a){i||(U(e.$$.fragment,a),U(l),i=!0)},o(a){z(e.$$.fragment,a),z(l),i=!1},d(a){a&&(Y(n),Y(r)),ie(e,a),c[t].d(a)}}}function Pn(o,e,n){let{value:t}=e,{label:l=void 0}=e,{show_label:r}=e,{show_download_button:i=!0}=e,{selectable:u=!1}=e,{show_share_button:c=!1}=e,{root:s}=e,{i18n:a}=e;const _=Rn(),f=h=>{let C=mt(h);C&&_("select",{index:C,value:null})},m=async h=>h?`<img src="${await $t(h,"base64")}" />`:"";function p(h){Xe.call(this,o,h)}function k(h){Xe.call(this,o,h)}return o.$$set=h=>{"value"in h&&n(0,t=h.value),"label"in h&&n(1,l=h.label),"show_label"in h&&n(2,r=h.show_label),"show_download_button"in h&&n(3,i=h.show_download_button),"selectable"in h&&n(4,u=h.selectable),"show_share_button"in h&&n(5,c=h.show_share_button),"root"in h&&n(8,s=h.root),"i18n"in h&&n(6,a=h.i18n)},o.$$.update=()=>{o.$$.dirty&257&&n(0,t=We(t,s,null))},[t,l,r,i,u,c,a,f,s,m,p,k]}class Ln extends En{constructor(e){super(),Bn(this,e,Pn,An,Un,{value:0,label:1,show_label:2,show_download_button:3,selectable:4,show_share_button:5,root:8,i18n:6})}}const uo=Ln;const{SvelteComponent:Nn,action_destroyer:Vn,append:P,attr:y,binding_callbacks:Zn,check_outros:te,create_component:se,destroy_component:ce,destroy_each:Fn,detach:N,element:R,empty:On,ensure_array_like:Qe,group_outros:ne,init:Xn,insert:V,is_function:Yn,listen:be,mount_component:ue,noop:Gn,run_all:Jn,safe_not_equal:Kn,set_data:Qn,space:_e,stop_propagation:xn,text:el,toggle_class:pe,transition_in:I,transition_out:E}=window.__gradio__svelte__internal,{createEventDispatcher:tl,onMount:nl,tick:_o}=window.__gradio__svelte__internal;function xe(o,e,n){const t=o.slice();return t[26]=e[n],t}function et(o){let e,n,t,l,r,i,u,c,s;const a=[ol,ll],_=[];function f(p,k){return p[1]==="video"?0:1}t=f(o),l=_[t]=a[t](o);let m=!o[5]&&tt(o);return{c(){e=R("div"),n=R("button"),l.c(),i=_e(),m&&m.c(),y(n,"aria-label",r=o[1]==="image"?"capture photo":"start recording"),y(n,"class","svelte-5ln13g"),y(e,"class","button-wrap svelte-5ln13g"),pe(e,"capture",!o[5])},m(p,k){V(p,e,k),P(e,n),_[t].m(n,null),P(e,i),m&&m.m(e,null),u=!0,c||(s=be(n,"click",function(){Yn(o[1]==="image"?o[8]:o[9])&&(o[1]==="image"?o[8]:o[9]).apply(this,arguments)}),c=!0)},p(p,k){o=p;let h=t;t=f(o),t===h?_[t].p(o,k):(ne(),E(_[h],1,1,()=>{_[h]=null}),te(),l=_[t],l?l.p(o,k):(l=_[t]=a[t](o),l.c()),I(l,1),l.m(n,null)),(!u||k&2&&r!==(r=o[1]==="image"?"capture photo":"start recording"))&&y(n,"aria-label",r),o[5]?m&&(ne(),E(m,1,1,()=>{m=null}),te()):m?(m.p(o,k),k&32&&I(m,1)):(m=tt(o),m.c(),I(m,1),m.m(e,null)),(!u||k&32)&&pe(e,"capture",!o[5])},i(p){u||(I(l),I(m),u=!0)},o(p){E(l),E(m),u=!1},d(p){p&&N(e),_[t].d(),m&&m.d(),c=!1,s()}}}function ll(o){let e,n,t;return n=new Rt({}),{c(){e=R("div"),se(n.$$.fragment),y(e,"class","icon svelte-5ln13g"),y(e,"title","capture photo")},m(l,r){V(l,e,r),ue(n,e,null),t=!0},p:Gn,i(l){t||(I(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&N(e),ce(n)}}}function ol(o){let e,n,t,l;const r=[il,rl],i=[];function u(c,s){return c[5]?0:1}return e=u(o),n=i[e]=r[e](o),{c(){n.c(),t=On()},m(c,s){i[e].m(c,s),V(c,t,s),l=!0},p(c,s){let a=e;e=u(c),e!==a&&(ne(),E(i[a],1,1,()=>{i[a]=null}),te(),n=i[e],n||(n=i[e]=r[e](c),n.c()),I(n,1),n.m(t.parentNode,t))},i(c){l||(I(n),l=!0)},o(c){E(n),l=!1},d(c){c&&N(t),i[e].d(c)}}}function rl(o){let e,n,t;return n=new Vt({}),{c(){e=R("div"),se(n.$$.fragment),y(e,"class","icon svelte-5ln13g"),y(e,"title","start recording")},m(l,r){V(l,e,r),ue(n,e,null),t=!0},i(l){t||(I(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&N(e),ce(n)}}}function il(o){let e,n,t;return n=new rn({}),{c(){e=R("div"),se(n.$$.fragment),y(e,"class","icon svelte-5ln13g"),y(e,"title","stop recording")},m(l,r){V(l,e,r),ue(n,e,null),t=!0},i(l){t||(I(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&N(e),ce(n)}}}function tt(o){let e,n,t,l,r,i,u,c;t=new dt({});let s=o[7]&&nt(o);return{c(){e=R("button"),n=R("div"),se(t.$$.fragment),l=_e(),s&&s.c(),y(n,"class","icon svelte-5ln13g"),y(n,"title","select video source"),y(e,"aria-label",r=o[1]==="image"?"capture photo":"start recording"),y(e,"class","svelte-5ln13g")},m(a,_){V(a,e,_),P(e,n),ue(t,n,null),P(e,l),s&&s.m(e,null),i=!0,u||(c=be(e,"click",o[10]),u=!0)},p(a,_){a[7]?s?(s.p(a,_),_&128&&I(s,1)):(s=nt(a),s.c(),I(s,1),s.m(e,null)):s&&(ne(),E(s,1,1,()=>{s=null}),te()),(!i||_&2&&r!==(r=a[1]==="image"?"capture photo":"start recording"))&&y(e,"aria-label",r)},i(a){i||(I(t.$$.fragment,a),I(s),i=!0)},o(a){E(t.$$.fragment,a),E(s),i=!1},d(a){a&&N(e),ce(t),s&&s.d(),u=!1,c()}}}function nt(o){let e,n,t,l,r,i,u;t=new dt({});let c=Qe(o[6]),s=[];for(let a=0;a<c.length;a+=1)s[a]=lt(xe(o,c,a));return{c(){e=R("div"),n=R("span"),se(t.$$.fragment),l=_e();for(let a=0;a<s.length;a+=1)s[a].c();y(n,"class","inset-icon svelte-5ln13g"),y(e,"class","select-wrap svelte-5ln13g")},m(a,_){V(a,e,_),P(e,n),ue(t,n,null),P(e,l);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(e,null);r=!0,i||(u=[be(n,"click",xn(o[17])),Vn(Ae.call(null,e,o[12]))],i=!0)},p(a,_){if(_&2112){c=Qe(a[6]);let f;for(f=0;f<c.length;f+=1){const m=xe(a,c,f);s[f]?s[f].p(m,_):(s[f]=lt(m),s[f].c(),s[f].m(e,null))}for(;f<s.length;f+=1)s[f].d(1);s.length=c.length}},i(a){r||(I(t.$$.fragment,a),r=!0)},o(a){E(t.$$.fragment,a),r=!1},d(a){a&&N(e),ce(t),Fn(s,a),i=!1,Jn(u)}}}function lt(o){let e,n=o[26].label+"",t,l,r,i;function u(){return o[18](o[26])}return{c(){e=R("div"),t=el(n),l=_e(),y(e,"class","svelte-5ln13g")},m(c,s){V(c,e,s),P(e,t),P(e,l),r||(i=be(e,"click",u),r=!0)},p(c,s){o=c,s&64&&n!==(n=o[26].label+"")&&Qn(t,n)},d(c){c&&N(e),r=!1,i()}}}function al(o){let e,n,t,l,r=!o[0]&&et(o);return{c(){e=R("div"),n=R("video"),t=_e(),r&&r.c(),y(n,"class","svelte-5ln13g"),pe(n,"flip",o[2]),y(e,"class","wrap svelte-5ln13g")},m(i,u){V(i,e,u),P(e,n),o[16](n),P(e,t),r&&r.m(e,null),l=!0},p(i,[u]){(!l||u&4)&&pe(n,"flip",i[2]),i[0]?r&&(ne(),E(r,1,1,()=>{r=null}),te()):r?(r.p(i,u),u&1&&I(r,1)):(r=et(i),r.c(),I(r,1),r.m(e,null))},i(i){l||(I(r),l=!0)},o(i){E(r),l=!1},d(i){i&&N(e),o[16](null),r&&r.d()}}}function Ae(o,e){const n=t=>{o&&!o.contains(t.target)&&!t.defaultPrevented&&e(t)};return document.addEventListener("click",n,!0),{destroy(){document.removeEventListener("click",n,!0)}}}function sl(o,e,n){let t,l,{streaming:r=!1}=e,{pending:i=!1}=e,{mode:u="image"}=e,{mirror_webcam:c}=e,{include_audio:s}=e,{i18n:a}=e;const _=tl();nl(()=>l=document.createElement("canvas"));async function f(b){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("error",a("image.no_webcam_support"));return}try{h=await navigator.mediaDevices.getUserMedia({video:b?{deviceId:{exact:b}}:!0,audio:s}),n(4,t.srcObject=h,t),n(4,t.muted=!0,t),t.play()}catch(S){if(S instanceof DOMException&&S.name=="NotAllowedError")_("error",a("image.allow_webcam_access"));else throw S}}function m(){var b=l.getContext("2d");t.videoWidth&&t.videoHeight&&(l.width=t.videoWidth,l.height=t.videoHeight,b.drawImage(t,0,0,t.videoWidth,t.videoHeight),c&&(b.scale(-1,1),b.drawImage(t,-t.videoWidth,0)),l.toBlob(S=>{_(r?"stream":"capture",S)},"image/png",.8))}let p=!1,k=[],h,C,M;function L(){if(p){M.stop();let b=new Blob(k,{type:C}),S=new FileReader;S.onload=function(fe){fe.target&&(_("capture",{data:fe.target.result,name:"sample."+C.substring(6),is_example:!1,is_file:!1}),_("stop_recording"))},S.readAsDataURL(b)}else{_("start_recording"),k=[];let b=["video/webm","video/mp4"];for(let S of b)if(MediaRecorder.isTypeSupported(S)){C=S;break}if(C===null){console.error("No supported MediaRecorder mimeType");return}M=new MediaRecorder(h,{mimeType:C}),M.addEventListener("dataavailable",function(S){k.push(S.data)}),M.start(200)}n(5,p=!p)}f(),r&&u==="image"&&window.setInterval(()=>{t&&!i&&m()},500);async function v(){const b=await navigator.mediaDevices.enumerateDevices();n(6,g=b.filter(S=>S.kind==="videoinput")),n(7,B=!0)}let g=[];async function w(b){await f(b),n(7,B=!1)}let B=!1;function T(b){b.preventDefault(),b.stopPropagation(),n(7,B=!1)}function O(b){Zn[b?"unshift":"push"](()=>{t=b,n(4,t)})}const we=()=>n(7,B=!1),ve=b=>w(b.deviceId);return o.$$set=b=>{"streaming"in b&&n(0,r=b.streaming),"pending"in b&&n(13,i=b.pending),"mode"in b&&n(1,u=b.mode),"mirror_webcam"in b&&n(2,c=b.mirror_webcam),"include_audio"in b&&n(14,s=b.include_audio),"i18n"in b&&n(15,a=b.i18n)},[r,u,c,Ae,t,p,g,B,m,L,v,w,T,i,s,a,O,we,ve]}class cl extends Nn{constructor(e){super(),Xn(this,e,sl,al,Kn,{streaming:0,pending:13,mode:1,mirror_webcam:2,include_audio:14,i18n:15,click_outside:3})}get click_outside(){return Ae}}const ul=cl;const{SvelteComponent:_l,attr:fl,create_component:dl,destroy_component:ml,detach:gl,element:hl,init:pl,insert:bl,mount_component:wl,noop:vl,safe_not_equal:kl,transition_in:$l,transition_out:yl}=window.__gradio__svelte__internal,{createEventDispatcher:Cl}=window.__gradio__svelte__internal;function Il(o){let e,n,t;return n=new je({props:{Icon:Dt,label:"Remove Image"}}),n.$on("click",o[1]),{c(){e=hl("div"),dl(n.$$.fragment),fl(e,"class","svelte-s6ybro")},m(l,r){bl(l,e,r),wl(n,e,null),t=!0},p:vl,i(l){t||($l(n.$$.fragment,l),t=!0)},o(l){yl(n.$$.fragment,l),t=!1},d(l){l&&gl(e),ml(n)}}}function Sl(o){const e=Cl();return[e,t=>{e("remove_image"),t.stopPropagation()}]}class ql extends _l{constructor(e){super(),pl(this,e,Sl,Il,kl,{})}}const{SvelteComponent:Dl,add_flush_callback:Ml,append:me,attr:F,bind:El,binding_callbacks:gt,bubble:Ee,check_outros:x,create_component:J,create_slot:Wl,destroy_component:K,destroy_each:Bl,detach:le,element:Re,empty:ht,ensure_array_like:ot,get_all_dirty_from_scope:Hl,get_slot_changes:Ul,group_outros:ee,init:Rl,insert:oe,listen:Tl,mount_component:Q,noop:Te,safe_not_equal:jl,space:ge,src_url_equal:rt,toggle_class:it,transition_in:$,transition_out:q,update_slot_base:zl}=window.__gradio__svelte__internal,{createEventDispatcher:Al,tick:Pl}=window.__gradio__svelte__internal;function at(o,e,n){const t=o.slice();return t[32]=e[n],t}function st(o){let e,n;return e=new ql({}),e.$on("remove_image",o[20]),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p:Te,i(t){n||($(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ct(o){let e;const n=o[19].default,t=Wl(n,o,o[30],null);return{c(){t&&t.c()},m(l,r){t&&t.m(l,r),e=!0},p(l,r){t&&t.p&&(!e||r[0]&1073741824)&&zl(t,n,l,l[30],e?Ul(n,l[30],r,null):Hl(l[30]),null)},i(l){e||($(t,l),e=!0)},o(l){q(t,l),e=!1},d(l){t&&t.d(l)}}}function Ll(o){let e,n,t=o[0]===null&&!o[1]&&ct(o);return{c(){t&&t.c(),e=ht()},m(l,r){t&&t.m(l,r),oe(l,e,r),n=!0},p(l,r){l[0]===null&&!l[1]?t?(t.p(l,r),r[0]&3&&$(t,1)):(t=ct(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(ee(),q(t,1,1,()=>{t=null}),x())},i(l){n||($(t),n=!0)},o(l){q(t),n=!1},d(l){l&&le(e),t&&t.d(l)}}}function Nl(o){let e,n,t,l,r;return{c(){e=Re("img"),rt(e.src,n=o[0].url)||F(e,"src",n),F(e,"alt",t=o[0].alt_text),F(e,"class","svelte-1or8coj"),it(e,"selectable",o[7])},m(i,u){oe(i,e,u),l||(r=Tl(e,"click",o[15]),l=!0)},p(i,u){u[0]&1&&!rt(e.src,n=i[0].url)&&F(e,"src",n),u[0]&1&&t!==(t=i[0].alt_text)&&F(e,"alt",t),u[0]&128&&it(e,"selectable",i[7])},i:Te,o:Te,d(i){i&&le(e),l=!1,r()}}}function Vl(o){let e,n;return e=new ul({props:{mirror_webcam:o[6],streaming:o[5],mode:"image",include_audio:!1,i18n:o[9]}}),e.$on("capture",o[24]),e.$on("stream",o[25]),e.$on("error",o[26]),e.$on("drag",o[27]),e.$on("upload",o[28]),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l[0]&64&&(r.mirror_webcam=t[6]),l[0]&32&&(r.streaming=t[5]),l[0]&512&&(r.i18n=t[9]),e.$set(r)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ut(o){let e,n;return e=new Mn({props:{show_border:!o[0]?.url,$$slots:{default:[Zl]},$$scope:{ctx:o}}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l[0]&1&&(r.show_border=!t[0]?.url),l[0]&1073745920&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function _t(o){let e,n;function t(){return o[29](o[32])}return e=new je({props:{Icon:o[16][o[32]].icon,size:"large",padded:!1}}),e.$on("click",t),{c(){J(e.$$.fragment)},m(l,r){Q(e,l,r),n=!0},p(l,r){o=l;const i={};r[0]&4096&&(i.Icon=o[16][o[32]].icon),e.$set(i)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){q(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Zl(o){let e,n,t=ot(o[12]),l=[];for(let i=0;i<t.length;i+=1)l[i]=_t(at(o,t,i));const r=i=>q(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=ht()},m(i,u){for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(i,u);oe(i,e,u),n=!0},p(i,u){if(u[0]&200704){t=ot(i[12]);let c;for(c=0;c<t.length;c+=1){const s=at(i,t,c);l[c]?(l[c].p(s,u),$(l[c],1)):(l[c]=_t(s),l[c].c(),$(l[c],1),l[c].m(e.parentNode,e))}for(ee(),c=t.length;c<l.length;c+=1)r(c);x()}},i(i){if(!n){for(let u=0;u<t.length;u+=1)$(l[u]);n=!0}},o(i){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)q(l[u]);n=!1},d(i){i&&le(e),Bl(l,i)}}}function Fl(o){let e,n,t,l,r,i,u,c,s,a,_,f=o[4].length>1||o[4].includes("clipboard"),m;e=new ft({props:{show_label:o[3],Icon:ze,label:o[2]||"Image"}});let p=o[0]?.url&&st(o);function k(g){o[22](g)}let h={hidden:o[0]!==null||o[1]==="webcam",filetype:"image/*",root:o[8],disable_click:!o[4].includes("upload"),$$slots:{default:[Ll]},$$scope:{ctx:o}};o[10]!==void 0&&(h.dragging=o[10]),i=new qt({props:h}),o[21](i),gt.push(()=>El(i,"dragging",k)),i.$on("load",o[13]),i.$on("error",o[23]);const C=[Vl,Nl],M=[];function L(g,w){return g[1]==="webcam"?0:g[0]!==null&&!g[5]?1:-1}~(s=L(o))&&(a=M[s]=C[s](o));let v=f&&ut(o);return{c(){J(e.$$.fragment),n=ge(),t=Re("div"),p&&p.c(),l=ge(),r=Re("div"),J(i.$$.fragment),c=ge(),a&&a.c(),_=ge(),v&&v.c(),F(r,"class","upload-container svelte-1or8coj"),F(t,"data-testid","image"),F(t,"class","image-container svelte-1or8coj")},m(g,w){Q(e,g,w),oe(g,n,w),oe(g,t,w),p&&p.m(t,null),me(t,l),me(t,r),Q(i,r,null),me(r,c),~s&&M[s].m(r,null),me(t,_),v&&v.m(t,null),m=!0},p(g,w){const B={};w[0]&8&&(B.show_label=g[3]),w[0]&4&&(B.label=g[2]||"Image"),e.$set(B),g[0]?.url?p?(p.p(g,w),w[0]&1&&$(p,1)):(p=st(g),p.c(),$(p,1),p.m(t,l)):p&&(ee(),q(p,1,1,()=>{p=null}),x());const T={};w[0]&3&&(T.hidden=g[0]!==null||g[1]==="webcam"),w[0]&256&&(T.root=g[8]),w[0]&16&&(T.disable_click=!g[4].includes("upload")),w[0]&1073741827&&(T.$$scope={dirty:w,ctx:g}),!u&&w[0]&1024&&(u=!0,T.dragging=g[10],Ml(()=>u=!1)),i.$set(T);let O=s;s=L(g),s===O?~s&&M[s].p(g,w):(a&&(ee(),q(M[O],1,1,()=>{M[O]=null}),x()),~s?(a=M[s],a?a.p(g,w):(a=M[s]=C[s](g),a.c()),$(a,1),a.m(r,null)):a=null),w[0]&16&&(f=g[4].length>1||g[4].includes("clipboard")),f?v?(v.p(g,w),w[0]&16&&$(v,1)):(v=ut(g),v.c(),$(v,1),v.m(t,null)):v&&(ee(),q(v,1,1,()=>{v=null}),x())},i(g){m||($(e.$$.fragment,g),$(p),$(i.$$.fragment,g),$(a),$(v),m=!0)},o(g){q(e.$$.fragment,g),q(p),q(i.$$.fragment,g),q(a),q(v),m=!1},d(g){g&&(le(n),le(t)),K(e,g),p&&p.d(),o[21](null),K(i),~s&&M[s].d(),v&&v.d()}}}function Ol(o,e,n){let t,{$$slots:l={},$$scope:r}=e,{value:i}=e,{label:u=void 0}=e,{show_label:c}=e,{sources:s=["upload","clipboard","webcam"]}=e,{streaming:a=!1}=e,{pending:_=!1}=e,{mirror_webcam:f}=e,{selectable:m=!1}=e,{root:p}=e,{i18n:k}=e,h,{active_tool:C=null}=e;function M({detail:d}){n(0,i=We(d,p,null))}async function L(d){n(18,_=!0);const A=await h.load_files([new File([d],"webcam.png")]);n(0,i=A?.[0]||null),a||n(1,C=null),await Pl(),v(a?"stream":"change"),n(18,_=!1)}const v=Al();let g=!1;function w(d){let A=mt(d);A&&v("select",{index:A,value:null})}const B={upload:{icon:St,label:k("Upload"),order:0},webcam:{icon:dn,label:k("Webcam"),order:1},clipboard:{icon:Kt,label:k("Paste"),order:2}};async function T(d){switch(d){case"clipboard":navigator.clipboard.read().then(async A=>{for(let de=0;de<A.length;de++){const ke=A[de].types.find($e=>$e.startsWith("image/"));if(ke){A[de].getType(ke).then(async $e=>{const kt=await h.load_files([new File([$e],`clipboard.${ke.replace("image/","")}`)]);n(0,i=kt?.[0]||null)});break}}});break;case"webcam":n(1,C="webcam");break;case"upload":h.open_file_upload();break}}const O=()=>n(0,i=null);function we(d){gt[d?"unshift":"push"](()=>{h=d,n(11,h)})}function ve(d){g=d,n(10,g)}function b(d){Ee.call(this,o,d)}const S=d=>L(d.detail),fe=d=>L(d.detail);function pt(d){Ee.call(this,o,d)}function bt(d){Ee.call(this,o,d)}const wt=d=>L(d.detail),vt=d=>T(d);return o.$$set=d=>{"value"in d&&n(0,i=d.value),"label"in d&&n(2,u=d.label),"show_label"in d&&n(3,c=d.show_label),"sources"in d&&n(4,s=d.sources),"streaming"in d&&n(5,a=d.streaming),"pending"in d&&n(18,_=d.pending),"mirror_webcam"in d&&n(6,f=d.mirror_webcam),"selectable"in d&&n(7,m=d.selectable),"root"in d&&n(8,p=d.root),"i18n"in d&&n(9,k=d.i18n),"active_tool"in d&&n(1,C=d.active_tool),"$$scope"in d&&n(30,r=d.$$scope)},o.$$.update=()=>{o.$$.dirty[0]&257&&i&&!i.url&&n(0,i=We(i,p,null)),o.$$.dirty[0]&1024&&v("drag",g),o.$$.dirty[0]&16&&n(12,t=s.sort((d,A)=>B[d].order-B[A].order)),o.$$.dirty[0]&16&&s.length===1&&s[0]==="webcam"&&n(1,C="webcam")},[i,C,u,c,s,a,f,m,p,k,g,h,t,M,L,w,B,T,_,l,O,we,ve,b,S,fe,pt,bt,wt,vt,r]}class Xl extends Dl{constructor(e){super(),Rl(this,e,Ol,Fl,jl,{value:0,label:2,show_label:3,sources:4,streaming:5,pending:18,mirror_webcam:6,selectable:7,root:8,i18n:9,active_tool:1},null,[-1,-1])}}const fo=Xl;export{fo as I,uo as S,ul as W};
//# sourceMappingURL=ImageUploader-d8cf211c.js.map
